#!/bin/bash

echo "=== Clean Slate Restore ==="
echo ""
echo "ğŸ¯ You're right - the database is messed up."
echo ""
echo "The onboarding data not being saved means the profile creation/update"
echo "process is broken. Let's start fresh with a clean, working setup."
echo ""
echo "ğŸ”§ CLEAN SLATE APPROACH:"
echo "1. Go to Supabase SQL Editor"
echo "2. Run the SQL in database/clean_slate_restore.sql"
echo ""
echo "This will:"
echo "âœ… Drop the broken profiles table completely"
echo "âœ… Create a clean, simple profiles table"
echo "âœ… Set up proper RLS policies"
echo "âœ… Create a working trigger for automatic profile creation"
echo "âœ… Get you back to a working state"
echo ""
echo "âš ï¸  WARNING: This will delete all existing profile data!"
echo "But since the profiles are broken anyway, this is the cleanest fix."
echo ""
echo "ğŸ¯ After this, the edge function should work and onboarding data"
echo "   should be saved properly."
echo ""
echo "Press Enter to continue..."
read -r

echo "âœ… Run the clean slate restore to get back to a working database state."
